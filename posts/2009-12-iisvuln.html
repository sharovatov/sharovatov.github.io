<!DOCTYPE html>
<html>
<head>
    <title>critical IIS vulnerability</title>
    <meta name="generator" content="DocPad v6.60.3" />
    <style >html.wait {
	cursor: wait !important;
	opacity: 0;
	transition: opacity 0.5s ease;
}</style><link  rel="stylesheet" href="/styles/style.css" />
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <link rel="alternate" type="application/atom+xml" title="Vitaly Sharovato" href="/atom.xml">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimal-ui">
</head>
<body>
    <nav role="navigation">
        <ol class="menu">
            <li class="menu__item">
                <a class="menu__item__link" href="/">blog posts</a>
            </li>
            <li class="menu__item">
                <a class="menu__item__link" href="/books.html">books read</a>
            </li>
        </ol>
    </nav>
    <div class="wrapper">
        <h1>critical IIS vulnerability</h1>
<p>Just got a link from our <a href="http://trukhanov.wordpress.com">system administrator</a> &#8211; <a title="http://securityvulns.ru/Wdocument993.html" href="http://securityvulns.ru/Wdocument993.html"><a href="http://securityvulns.ru/Wdocument993.html">http://securityvulns.ru/Wdocument993.html</a></a></p>
<p>Go read the vulnerability description now!</p>
<p>Basically – if your users upload files to your site and THEY specify file names, you’re vulnerable:</p>
<blockquote>
<p><strong>Vulnerability/Risk Description</strong>:</p>
<p>IIS can execute any extension as an Active Server Page or any other executable extension.</p>
<p>For instance “malicious.asp;.jpg” is executed as an ASP file on the server. Many file uploaders protect the system by checking only the last section of the filename as its extension. And by using this vulnerability, an attacker can bypass this protection and upload a dangerous executable file on the server.</p>
</blockquote>
<p>There’s an unchecked <a href="http://securityvulns.ru/files/iissemi1.cpp">patch</a> for this vulnerability, but again this shows that you just can’t allow any user input saved to your system without filtering.</p>
<p>So, if you allow file uploads – your script has to specify filenames, not users.</p>

<div class="comments"><div id="disqus_thread"></div>
<script>
	(function(){
		window.disqus_shortname = 'sharovatov';
		window.disqus_developer = '1';
		window.disqus_url = 'http://sharovatov.github.io/posts/2009-12-iisvuln.html';
		window.disqus_identifier = 'posts-2009-12-iisvuln';
		window.disqus_title = 'critical IIS vulnerability';
		if ( window.DISQUS ) {
			return DISQUS.reset({
				reload: true,
				config: function () {
					this.page.identifier = window.disqus_identifier;
					this.page.url = window.disqus_url;
					this.page.title = window.disqus_title;
				}
			});
		}
		else {
		  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		  dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
		  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
		}
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></div>
    </div>
    <script >(function(){
	/* Did we just livereload? */
var log = !!(localStorage && console && console.log && true);
if ( log && localStorage.getItem('/docpad-livereload/reloaded') === 'yes' ) {
	localStorage.removeItem('/docpad-livereload/reloaded');
	console.log('LiveReload completed at', new Date())
}

/* Listen for the regenerated event and perform a reload of the page when the event occurs */
var listen = function(){
	var primus = new Primus('/docpad-livereload');
	primus.on('data', function(data){
		if ( data && data.message ) {
			if ( data.message === 'generateBefore' ) {
				if ( log ) {
					console.log('LiveReload started at', new Date());
				}
				if ( typeof document.getElementsByTagName !== 'undefined' ) {
	document.getElementsByTagName('html')[0].className += ' wait';
}
			}
			else if ( data.message === 'generateAfter' ) {
				if ( log ) {
					localStorage.setItem('/docpad-livereload/reloaded', 'yes');
				}
				document.location.reload();
			}
		}
	});
};
	/* Inject socket into our page */
var inject = function(){
	var t = document.createElement('script');
	t.type = 'text/javascript';
	t.async = 'async';
	t.src = '/primus/primus.js';
	t.onload = listen;
	var s = document.getElementsByTagName('script')[0];
	s.parentNode.insertBefore(t, s);
};
	if ( typeof Primus !== 'undefined' ) {
		listen();
	} else {
		inject();
	}
})();</script>
</body>
</html>