<!DOCTYPE html>
<html>
<head>
    <title>critical IIS vulnerability</title>
	<meta property="og:title" content="Виталий Шароватов о разработке и людях">
	<meta property="og:description" content="Социально-технические системы — не только просто, но и сложно">
	<meta property="og:type" content="website">
	<meta property="og:image" content="https://sharovatov.github.io/me.jpg">
	<meta property="og:url" content="https://sharovatov.github.io">
    <link  rel="stylesheet" href="/styles/style.css" />
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <link rel="alternate" type="application/atom+xml" title="Vitaly Sharovatov" href="/atom.xml">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimal-ui">
</head>
<body>
    <div class="wrapper">
        <h1>critical IIS vulnerability</h1>
<p>Just got a link from our <a href="http://trukhanov.wordpress.com">system administrator</a> &#8211; <a title="http://securityvulns.ru/Wdocument993.html" href="http://securityvulns.ru/Wdocument993.html">http://securityvulns.ru/Wdocument993.html</a></p>
<p>Go read the vulnerability description now!</p>
<p>Basically – if your users upload files to your site and THEY specify file names, you’re vulnerable:</p>
<blockquote>
<p><strong>Vulnerability/Risk Description</strong>:</p>
</blockquote>
<blockquote>
<p>IIS can execute any extension as an Active Server Page or any other executable extension.</p>
</blockquote>
<blockquote>
<p>For instance “malicious.asp;.jpg” is executed as an ASP file on the server. Many file uploaders protect the system by checking only the last section of the filename as its extension. And by using this vulnerability, an attacker can bypass this protection and upload a dangerous executable file on the server.</p>
</blockquote>
<p>There’s an unchecked <a href="http://securityvulns.ru/files/iissemi1.cpp">patch</a> for this vulnerability, but again this shows that you just can’t allow any user input saved to your system without filtering.</p>
<p>So, if you allow file uploads – your script has to specify filenames, not users.</p>

<div class="comments"><div id="disqus_thread"></div>
<script>
	(function(){
		window.disqus_shortname = 'sharovatov';
		window.disqus_developer = '1';
		window.disqus_url = 'http://sharovatov.github.io/posts/2009-12-iisvuln.html';
		window.disqus_identifier = 'posts-2009-12-iisvuln';
		window.disqus_title = 'critical IIS vulnerability';
		if ( window.DISQUS ) {
			return DISQUS.reset({
				reload: true,
				config: function () {
					this.page.identifier = window.disqus_identifier;
					this.page.url = window.disqus_url;
					this.page.title = window.disqus_title;
				}
			});
		}
		else {
		  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		  dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
		  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
		}
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></div>
    </div>
    
</body>
</html>